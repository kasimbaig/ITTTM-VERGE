<nav class="top-navbar bg-white shadow-md border-b border-gray-200">
  <div class="navbar-container flex items-center justify-between px-6 py-3">
    <!-- Logo/Brand -->
    <div class="flex items-center gap-3">
      <i class="fa-solid fa-ship text-blue-600 text-2xl"></i>
      <span class="text-xl font-bold text-gray-800">ITTTM</span>
    </div>

    <!-- Hamburger Menu Toggle -->
    <button
      class="hamburger-toggle md:hidden px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors"
      (click)="toggleSidebar()">
      <i class="fa-solid" [ngClass]="expanded ? 'fa-times' : 'fa-bars'"></i>
    </button>

    <!-- Main Navigation (Desktop) -->
    <div
      class="nav-menu flex items-center gap-1 flex-1 justify-center"
      [class.nav-menu-expanded]="expanded"
      [class.nav-menu-collapsed]="!expanded">
      <ng-container *ngFor="let item of menuItems">
        <!-- Parent Menu Item without Children -->
        <div class="relative" *ngIf="!item.hasChildren">
          <button
            (click)="item.path && navigateTo(item.path)"
            class="px-4 py-2 text-sm font-medium rounded-lg transition-colors flex items-center gap-2"
            [class.bg-blue-50]="item.path && isActive(item.path)"
            [class.text-blue-600]="item.path && isActive(item.path)"
            [class.text-gray-700]="!(item.path && isActive(item.path))"
            [class.hover:bg-gray-100]="!(item.path && isActive(item.path))">
            <i [ngClass]="item.icon" class="text-sm"></i>
            <span>{{ item.label }}</span>
          </button>
        </div>

        <!-- Parent Menu Item with Dropdown -->
        <div class="relative dropdown-container" *ngIf="item.hasChildren">
          <button
            (click)="toggleSubMenu(item.path!)"
            class="px-4 py-2 text-sm font-medium rounded-lg transition-colors flex items-center gap-2"
            [class.bg-blue-50]="item.path && openSubMenus[item.path]"
            [class.text-blue-600]="item.path && openSubMenus[item.path]"
            [class.text-gray-700]="!(item.path && openSubMenus[item.path])"
            [class.hover:bg-gray-100]="!(item.path && openSubMenus[item.path])">
            <i [ngClass]="item.icon" class="text-sm"></i>
            <span>{{ item.label }}</span>
            <i class="pi pi-angle-down text-xs transition-transform" [class.rotate-180]="item.path && openSubMenus[item.path]"></i>
          </button>

          <!-- Dropdown Menu -->
          <div
            *ngIf="item.path && openSubMenus[item.path]"
            class="dropdown-menu absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg min-w-[200px] py-1 z-50">
            <ng-container *ngFor="let subItem of item.children">
              <!-- Submenu Item without Children -->
              <button
                *ngIf="!subItem.hasChildren"
                (click)="subItem.path && navigateTo(subItem.path)"
                class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2 transition-colors"
                [class.bg-blue-50]="subItem.path && isActive(subItem.path)"
                [class.text-blue-600]="subItem.path && isActive(subItem.path)">
                <i [ngClass]="subItem.icon" class="text-xs"></i>
                <span>{{ subItem.label }}</span>
              </button>

              <!-- Submenu Item with Nested Children -->
              <div *ngIf="subItem.hasChildren" class="relative">
                <button
                  (click)="toggleSubMenu(subItem.path!)"
                  class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center justify-between transition-colors">
                  <div class="flex items-center gap-2">
                    <i [ngClass]="subItem.icon" class="text-xs"></i>
                    <span>{{ subItem.label }}</span>
                  </div>
                  <i class="pi pi-angle-right text-xs"></i>
                </button>

                <!-- Nested Submenu -->
                <div
                  *ngIf="subItem.path && openSubMenus[subItem.path]"
                  class="pl-4 nested-submenu">
                  <button
                    *ngFor="let nested of subItem.children"
                    (click)="nested.path && navigateTo(nested.path)"
                    class="w-full text-left px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 flex items-center gap-2 transition-colors"
                    [class.bg-blue-50]="nested.path && isActive(nested.path)"
                    [class.text-blue-600]="nested.path && isActive(nested.path)">
                    <i [ngClass]="nested.icon" class="text-xs"></i>
                    <span>{{ nested.label }}</span>
                  </button>
                </div>
              </div>
            </ng-container>
          </div>
        </div>
      </ng-container>
    </div>

    <!-- Right Side: Logout -->
    <div class="flex items-center gap-3">
      <!-- Logout Button -->
      <button
        (click)="showLogoutDialog=true"
        class="px-4 py-2 text-sm font-medium text-red-600 hover:bg-red-50 rounded-lg transition-colors flex items-center gap-2">
        <i class="fa-solid fa-sign-out-alt"></i>
        <span class="hidden sm:inline">Logout</span>
      </button>
    </div>
  </div>
</nav>


<!-- Logout Confirmation Dialog -->
<div *ngIf="showLogoutDialog" class="fixed inset-0 flex items-center justify-center z-50 bg-gray-100/70">
  <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4">
    <div class="mb-6 flex flex-col items-center">
      <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4">
        <i class="fa-solid fa-sign-out-alt text-red-600 text-2xl"></i>
      </div>
      <h3 class="text-xl font-bold text-gray-900 mb-2">Confirm Logout</h3>
    </div>
    <p class="text-gray-600 leading-relaxed mb-6">Are you sure you want to sign out of your account? You'll need to log in again to access your dashboard.</p>

    <div class="flex gap-3 justify-end">
      <button
        (click)="showLogoutDialog = false"
        class="px-6 py-3 text-sm font-semibold text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-all">
        <i class="fa-solid fa-times mr-2"></i>
        Cancel
      </button>
      <button
        (click)="logOut()"
        class="px-6 py-3 text-sm font-semibold text-white bg-red-600 hover:bg-red-700 rounded-lg transition-all">
        <i class="fa-solid fa-sign-out-alt mr-2"></i>
        Logout
      </button>
    </div>
  </div>
</div>
